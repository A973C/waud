/*!
 * waud.js - v0.0.3
 * Compiled on 12-12-2015 11:12:24
 * waud.js is licensed under the MIT License.
 * Copyright (c) 2015-2016 Adi Reddy Mora
*/
!function(a,b){"use strict";function c(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function d(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=p++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}var e=function(){this.bufferList=new m,this.playingSounds=new m};e.prototype={checkWebAudioAPISupport:function(){return null!=g.field(window,"AudioContext")?(e.AudioContextClass=g.field(window,"AudioContext"),!0):null!=g.field(window,"webkitAudioContext")?(e.AudioContextClass=g.field(window,"webkitAudioContext"),!0):!1},unlockAudio:function(){var a=this;if(null!=this.audioContext){var b=this.audioContext.createBuffer(1,1,j.preferredSampleRate),c=this.audioContext.createBufferSource();c.buffer=b,c.connect(this.audioContext.destination),c.start(0),c.onended=function(){null!=j.__touchUnlockCallback&&j.__touchUnlockCallback(),j.dom.removeEventListener("touchend",d(a,a.unlockAudio),!0)}}},createAudioContext:function(){if(null==this.audioContext)try{null!=e.AudioContextClass&&(this.audioContext=h.createInstance(e.AudioContextClass,[]))}catch(a){a instanceof n&&(a=a.val),this.audioContext=null}},iOSSafeSampleRateCheck:function(){if(null!=this.audioContext&&j.iOSSafeSampleRateCheck&&this.audioContext.sampleRate!=j.preferredSampleRate){var a=this.audioContext.createBuffer(1,1,j.preferredSampleRate),b=this.audioContext.createBufferSource();b.buffer=a,b.connect(this.audioContext.destination),b.start(0),b.disconnect(),this.destroyContext(),this.createAudioContext()}},destroyContext:function(){null!=this.audioContext&&(null!=j.audioContext.close&&j.audioContext.close(),this.audioContext=null)}};var f=function(a,b){b=b.split("u").join(""),this.r=new RegExp(a,b)};f.prototype={match:function(a){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(a),this.r.s=a,null!=this.r.m}};var g=function(){};g.field=function(a,b){try{return a[b]}catch(c){return c instanceof n&&(c=c.val),null}};var h=function(){};h.createInstance=function(a,b){var c=b.length;switch(c){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw new n("Too many arguments")}return null};var i=function(){};i.isiOS=function(){return new f("(iPad|iPhone|iPod)","i").match(window.navigator.userAgent)};var j=b.Waud=function(){};j.init=function(a){null==a&&(a=window.document),j.dom=a;var b=window.document;j.audioElement=b.createElement("audio"),null==j.audioManager&&(j.audioManager=new e),j.isWebAudioSupported=j.audioManager.checkWebAudioAPISupport(),j.isAudioSupported=null!=g.field(window,"Audio"),j.isWebAudioSupported?(j.audioManager.createAudioContext(),i.isiOS()&&j.audioManager.iOSSafeSampleRateCheck()):!j.isAudioSupported,j.defaults.autoplay=!1,j.defaults.loop=!1,j.defaults.preload="metadata",j.defaults.volume=1,j.sounds=new m,j.types=new m,j.types.set("mp3","audio/mpeg"),j.types.set("ogg","audio/ogg"),j.types.set("wav","audio/wav"),j.types.set("aac","audio/aac"),j.types.set("m4a","audio/x-m4a")},j.enableTouchUnlock=function(a){j.__touchUnlockCallback=a,j.dom.addEventListener("touchend",(o=j.audioManager,d(o,o.unlockAudio)),!0)},j.mute=function(a){for(var b=j.sounds.iterator();b.hasNext();){var c=b.next();c.mute(a)}},j.stop=function(){for(var a=j.sounds.iterator();a.hasNext();){var b=a.next();b.stop()}},j.getSupportString=function(){var a="OGG: "+j.audioElement.canPlayType('audio/ogg; codecs="vorbis"');return a+=", WAV: "+j.audioElement.canPlayType('audio/wav; codecs="1"'),a+=", MP3: "+j.audioElement.canPlayType("audio/mpeg;"),a+=", AAC: "+j.audioElement.canPlayType("audio/aac;"),a+=", M4A: "+j.audioElement.canPlayType("audio/x-m4a;")},j.isOGGSupported=function(){var a=j.audioElement.canPlayType('audio/ogg; codecs="vorbis"');return j.isAudioSupported&&null!=a&&("probably"==a||"maybe"==a)},j.isWAVSupported=function(){var a=j.audioElement.canPlayType('audio/wav; codecs="1"');return j.isAudioSupported&&null!=a&&("probably"==a||"maybe"==a)},j.isMP3Supported=function(){var a=j.audioElement.canPlayType("audio/mpeg;");return j.isAudioSupported&&null!=a&&("probably"==a||"maybe"==a)},j.isAACSupported=function(){var a=j.audioElement.canPlayType("audio/aac;");return j.isAudioSupported&&null!=a&&("probably"==a||"maybe"==a)},j.isM4ASupported=function(){var a=j.audioElement.canPlayType("audio/x-m4a;");return j.isAudioSupported&&null!=a&&("probably"==a||"maybe"==a)};var k=function(){},l=function(a,b){this.map=a,this.keys=b,this.index=0,this.count=b.length};l.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])}};var m=function(){this.h={}};m.__interfaces__=[k],m.prototype={set:function(a,b){null!=q[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=q[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new l(this,this.arrayKeys())}};var n=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,n)};n.__super__=Error,n.prototype=c(Error.prototype,{});var o,p=0,q={};j.defaults={},j.iOSSafeSampleRateCheck=!0,j.preferredSampleRate=44100,j.unlocked=!1}("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:exports);