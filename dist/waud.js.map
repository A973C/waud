{
"version":3,
"file":"waud.js",
"sourceRoot":"file:///",
"sources":["C:/projects/waud/src/AudioManager.hx","C:/projects/waud/src/BaseSound.hx","C:/HaxeToolkit/haxe/std/js/_std/EReg.hx","C:/projects/waud/src/HTML5Sound.hx","C:/HaxeToolkit/haxe/std/js/_std/HxOverrides.hx","C:/HaxeToolkit/haxe/std/js/_std/Reflect.hx","C:/HaxeToolkit/haxe/std/js/_std/Std.hx","C:/HaxeToolkit/haxe/std/js/_std/Type.hx","C:/projects/waud/src/Waud.hx","C:/projects/waud/src/WaudFocusManager.hx","C:/projects/waud/src/WaudSound.hx","C:/projects/waud/src/WaudUtils.hx","C:/projects/waud/src/WebAudioAPISound.hx","C:/HaxeToolkit/haxe/std/haxe/Timer.hx","C:/HaxeToolkit/haxe/std/js/_std/haxe/ds/StringMap.hx","C:/HaxeToolkit/haxe/std/js/Boot.hx"],
"sourcesContent":["import js.html.AudioElement;\r\nimport js.html.SourceElement;\r\nimport js.html.audio.AudioBufferSourceNode;\r\nimport js.html.audio.AudioContext;\r\nimport js.Browser;\r\n\r\nclass AudioManager {\r\n\r\n\t/**\r\n\t* Audio Types.\r\n\t*\r\n\t* @property types\r\n\t* @protected\r\n\t* @type {Map}\r\n\t*/\r\n\tpublic var types:Map<String, String>;\r\n\r\n\t/**\r\n\t* Audio Context instance.\r\n\t*\r\n\t* @property audioContext\r\n\t* @protected\r\n\t* @type {AudioContext}\r\n\t*/\r\n\tpublic var audioContext(default, null):AudioContext;\r\n\r\n\t/**\r\n\t* Audio buffer list.\r\n\t*\r\n\t* @property bufferList\r\n\t* @protected\r\n\t* @type {Map}\r\n\t*/\r\n\tpublic var bufferList:Map<String, Dynamic>;\r\n\r\n\t/**\r\n\t* Audio Context Class determined based on the browser type. Refer {{#crossLink \"AudioManager/checkWebAudioAPISupport:method\"}}{{/crossLink}} method.\r\n\t*\r\n\t* @property AudioContextClass\r\n\t* @static\r\n\t* @private\r\n\t* @type {AudioContext|webkitAudioContext}\r\n\t*/\r\n\tstatic var AudioContextClass:Dynamic;\r\n\r\n\tstatic inline var AUDIO_CONTEXT:String = \"this.audioContext\";\r\n\r\n\t/**\r\n\t* Audio Manager class instantiated in {{#crossLink \"Waud/init:method\"}}Waud.init{{/crossLink}} method.\r\n\t*\r\n\t* @class AudioManager\r\n\t* @constructor\r\n\t* @example\r\n\t* \t\tWaud.audioManager\r\n\t*/\r\n\tpublic function new() {\r\n\t\tbufferList = new Map();\r\n\r\n\t\ttypes = new Map();\r\n\t\ttypes.set(\"mp3\", \"audio/mpeg\");\r\n\t\ttypes.set(\"ogg\", \"audio/ogg\");\r\n\t\ttypes.set(\"wav\", \"audio/wav\");\r\n\t\ttypes.set(\"aac\", \"audio/aac\");\r\n\t\ttypes.set(\"m4a\", \"audio/x-m4a\");\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check web audio api support.\r\n\t*\r\n\t* Used by {{#crossLink \"Waud/init:method\"}}Waud.init{{/crossLink}} method.\r\n\t*\r\n\t* @method checkWebAudioAPISupport\r\n\t*/\r\n\tpublic function checkWebAudioAPISupport():Bool {\r\n\t\tif (Reflect.field(Browser.window, \"AudioContext\") != null) {\r\n\t\t\tAudioContextClass = Reflect.field(Browser.window, \"AudioContext\");\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse if (Reflect.field(Browser.window, \"webkitAudioContext\") != null) {\r\n\t\t\tAudioContextClass = Reflect.field(Browser.window, \"webkitAudioContext\");\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to unlock audio on `touchend` event.\r\n\t*\r\n\t* Used by {{#crossLink \"Waud/enableTouchUnlock:method\"}}Waud.enableTouchUnlock{{/crossLink}} method.\r\n\t*\r\n\t* @method unlockAudio\r\n\t*/\r\n\tpublic function unlockAudio() {\r\n\t\tif (audioContext != null) {\r\n\t\t\tvar bfr = audioContext.createBuffer(1, 1, Waud.preferredSampleRate);\r\n\t\t\tvar src:AudioBufferSourceNode = audioContext.createBufferSource();\r\n\t\t\tsrc.buffer = bfr;\r\n\t\t\tsrc.connect(audioContext.destination);\r\n\t\t\tif (Reflect.field(src, \"start\") != null) src.start(0);\r\n\t\t\telse untyped __js__(\"src\").noteOn(0);\r\n\t\t\tif (src.onended != null) src.onended = _unlockCallback;\r\n\t\t\telse haxe.Timer.delay(_unlockCallback, 1);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar audio:AudioElement = Browser.document.createAudioElement();\r\n\t\t\tvar source:SourceElement = Browser.document.createSourceElement();\r\n\t\t\tsource.src = \"data:audio/wave;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA==\";\r\n\t\t\taudio.appendChild(source);\r\n\t\t\tBrowser.document.appendChild(audio);\r\n\t\t\taudio.play();\r\n\t\t\t_unlockCallback();\r\n\t\t}\r\n\t}\r\n\r\n\tinline function _unlockCallback() {\r\n\t\tif (Waud.__touchUnlockCallback != null) Waud.__touchUnlockCallback();\r\n\t\tWaud.dom.ontouchend = null;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to create audio context.\r\n\t*\r\n\t* Used by {{#crossLink \"Waud/init:method\"}}Waud.init{{/crossLink}} method.\r\n\t*\r\n\t* @method createAudioContext\r\n\t* @return AudioContext\r\n\t*/\r\n\tpublic function createAudioContext():AudioContext {\r\n\t\tif (audioContext == null) {\r\n\t\t\ttry {\r\n\t\t\t\tif (AudioContextClass != null) audioContext = cast Type.createInstance(AudioContextClass, []);\r\n\t\t\t}\r\n\t\t\tcatch (e:Dynamic) {\r\n\t\t\t\taudioContext = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn audioContext;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to close audio context and reset all variables.\r\n\t*\r\n\t* Used by {{#crossLink \"Waud/destroy:method\"}}Waud.destroy{{/crossLink}} method.\r\n\t*\r\n\t* @method destroy\r\n\t*/\r\n\tpublic function destroy() {\r\n\t\tif (audioContext != null && untyped __js__(AUDIO_CONTEXT).close != null && untyped __js__(AUDIO_CONTEXT).close != \"\") {\r\n\t\t\tuntyped __js__(AUDIO_CONTEXT).close();\r\n\t\t}\r\n\t\taudioContext = null;\r\n\t\tbufferList = null;\r\n\t\ttypes = null;\r\n\t}\r\n\r\n\t/**\r\n\t* This function suspends the progression of time in the audio context, temporarily halting audio hardware access and reducing CPU/battery usage in the process.\r\n\t* This is useful if you want an application to power down the audio hardware when it will not be using an audio context for a while.\r\n\t*\r\n\t* @method suspendContext\r\n\t* @example\r\n\t*     Waud.audioManager.suspendContext();\r\n\t*/\r\n\tpublic function suspendContext() {\r\n\t\tif (audioContext != null) {\r\n\t\t\tif (untyped __js__(AUDIO_CONTEXT).suspend != null) untyped __js__(AUDIO_CONTEXT).suspend();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* This function resumes the progression of time in an audio context that has previously been suspended.\r\n\t*\r\n\t* @method resumeContext\r\n\t* @example\r\n\t*     Waud.audioManager.resumeContext();\r\n\t*/\r\n\tpublic function resumeContext() {\r\n\t\tif (audioContext != null) {\r\n\t\t\tif (untyped __js__(AUDIO_CONTEXT).resume != null) untyped __js__(AUDIO_CONTEXT).resume();\r\n\t\t}\r\n\t}\r\n}","@:keep class BaseSound {\r\n\r\n\tpublic var isSpriteSound:Bool;\r\n\tpublic var url:String;\r\n\tpublic var duration(get, null):Float;\r\n\r\n\tvar _options:WaudSoundOptions;\r\n\tvar _isLoaded:Bool;\r\n\tvar _isPlaying:Bool;\r\n\tvar _muted:Bool;\r\n\r\n\tpublic function new(sndUrl:String, ?options:WaudSoundOptions = null) {\r\n\t\tif (sndUrl == null || sndUrl == \"\") {\r\n\t\t\ttrace(\"invalid sound url\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Waud.audioManager == null) {\r\n\t\t\ttrace(\"initialise Waud using Waud.init() before loading sounds\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tduration = 0;\r\n\t\tisSpriteSound = false;\r\n\t\turl = sndUrl;\r\n\t\t_isLoaded = false;\r\n\t\t_isPlaying = false;\r\n\t\t_muted = false;\r\n\t\tif (options == null) options = {};\r\n\r\n\t\toptions.autoplay = (options.autoplay != null) ? options.autoplay : Waud.defaults.autoplay;\r\n\t\toptions.webaudio = (options.webaudio != null) ? options.webaudio : Waud.defaults.webaudio;\r\n\t\toptions.preload = (options.preload != null) ? options.preload : Waud.defaults.preload;\r\n\t\toptions.loop = (options.loop != null) ? options.loop : Waud.defaults.loop;\r\n\t\toptions.volume = (options.volume != null && options.volume >= 0 && options.volume <= 1) ? options.volume : Waud.defaults.volume;\r\n\t\toptions.onload = (options.onload != null) ? options.onload : Waud.defaults.onload;\r\n\t\toptions.onend = (options.onend != null) ? options.onend : Waud.defaults.onend;\r\n\t\toptions.onerror = (options.onerror != null) ? options.onerror : Waud.defaults.onerror;\r\n\r\n\t\t_options = options;\r\n\t}\r\n\r\n\tfunction get_duration():Float {\r\n\t\treturn 0;\r\n\t}\r\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : HaxeRegExp;\n\n\tpublic function new( r : String, opt : String ) : Void {\n\t\topt = opt.split(\"u\").join(\"\"); // 'u' (utf8) depends on page encoding\n\t\tthis.r = new HaxeRegExp(r, opt);\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n\n@:native(\"RegExp\")\nprivate extern class HaxeRegExp extends js.RegExp {\n\tvar m:js.RegExp.RegExpMatch;\n\tvar s:String;\n}\n","import haxe.Timer;\r\nimport js.html.SourceElement;\r\nimport js.html.AudioElement;\r\n\r\n@:keep class HTML5Sound extends BaseSound implements IWaudSound {\r\n\r\n\tvar _snd:AudioElement;\r\n\tvar _src:SourceElement;\r\n\tvar _tmr:Timer;\r\n\r\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\r\n\t\tsuper(url, options);\r\n\t\t_snd = Waud.dom.createAudioElement();\r\n\t\t_addSource(url);\r\n\t\tif (_options.preload) load();\r\n\t}\r\n\r\n\tpublic function load(?callback:IWaudSound -> Void):IWaudSound {\r\n\t\tif (!_isLoaded) {\r\n\t\t\t_snd.autoplay = _options.autoplay;\r\n\t\t\t_snd.loop = _options.loop;\r\n\t\t\t_snd.volume = _options.volume;\r\n\r\n\t\t\tif (callback != null) _options.onload = callback;\r\n\r\n\t\t\tif (_options.preload) _snd.preload = \"auto\";\r\n\t\t\telse _snd.preload = \"metadata\"; //none\r\n\r\n\t\t\tif (_options.onload != null) {\r\n\t\t\t\t_isLoaded = true;\r\n\t\t\t\t_snd.onloadeddata = function() {\r\n\t\t\t\t\t_options.onload(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t_snd.onplaying = function() {\r\n\t\t\t\t_isPlaying = true;\r\n\t\t\t}\r\n\r\n\t\t\t_snd.onended = function() {\r\n\t\t\t\t_isPlaying = false;\r\n\t\t\t\tif (_options.onend != null) _options.onend(this);\r\n\t\t\t}\r\n\r\n\t\t\tif (_options.onerror != null) {\r\n\t\t\t\t_snd.onerror = function() {\r\n\t\t\t\t\t_options.onerror(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t_snd.load();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\toverride function get_duration():Float {\r\n\t\tif (!_isLoaded) return 0;\r\n\t\treturn duration = _snd.duration;\r\n\t}\r\n\r\n\tfunction _addSource(url:String):SourceElement {\r\n\t\t_src = Waud.dom.createSourceElement();\r\n\t\t_src.src = url;\r\n\r\n\t\tif (Waud.audioManager.types.get(_getExt(url)) != null) _src.type = Waud.audioManager.types.get(_getExt(url));\r\n\t\t_snd.appendChild(_src);\r\n\r\n\t\treturn _src;\r\n\t}\r\n\r\n\tfunction _getExt(filename:String):String {\r\n\t\treturn filename.split(\".\").pop();\r\n\t}\r\n\r\n\tpublic function setVolume(val:Float) {\r\n\t\tif (val >= 0 && val <= 1) _options.volume = val;\r\n\t\tif (!_isLoaded) return;\r\n\t\t_snd.volume = _options.volume;\r\n\t}\r\n\r\n\tpublic function getVolume():Float {\r\n\t\treturn _options.volume;\r\n\t}\r\n\r\n\tpublic function mute(val:Bool) {\r\n\t\tif (!_isLoaded) return;\r\n\t\t_snd.muted = val;\r\n\t\tif (WaudUtils.isiOS()) {\r\n\t\t\tif (val && isPlaying()) {\r\n\t\t\t\t_muted = true;\r\n\t\t\t\t_snd.pause();\r\n\t\t\t}\r\n\t\t\telse if (_muted) {\r\n\t\t\t\t_muted = false;\r\n\t\t\t\t_snd.play();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function toggleMute() {\r\n\t\tmute(!_muted);\r\n\t}\r\n\r\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties):Int {\r\n\t\tif (!_isLoaded || _snd == null) {\r\n\t\t\ttrace(\"sound not loaded\");\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tif (_muted) return -1;\r\n\t\tif (isSpriteSound && soundProps != null) {\r\n\t\t\t_snd.currentTime = soundProps.start;\r\n\t\t\tif (_tmr != null) _tmr.stop();\r\n\t\t\t_tmr = Timer.delay(function() {\r\n\t\t\t\tif (soundProps.loop != null && soundProps.loop) {\r\n\t\t\t\t\tplay(spriteName, soundProps);\r\n\t\t\t\t}\r\n\t\t\t\telse stop();\r\n\t\t\t},\r\n\t\t\tMath.ceil(soundProps.duration * 1000));\r\n\t\t}\r\n\t\tif (!_isPlaying) _snd.play();\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tpublic function togglePlay() {\r\n\t\tif (_isPlaying) pause();\r\n\t\telse play();\r\n\t}\r\n\r\n\tpublic function isPlaying():Bool {\r\n\t\treturn _isPlaying;\r\n\t}\r\n\r\n\tpublic function loop(val:Bool) {\r\n\t\tif (!_isLoaded || _snd == null) return;\r\n\t\t_snd.loop = val;\r\n\t}\r\n\r\n\tpublic function stop() {\r\n\t\tif (!_isLoaded || _snd == null) return;\r\n\t\t_snd.pause();\r\n\t\t_snd.currentTime = 0;\r\n\t\t_isPlaying = false;\r\n\t}\r\n\r\n\tpublic function pause() {\r\n\t\tif (!_isLoaded || _snd == null) return;\r\n\t\t_snd.pause();\r\n\t\t_isPlaying = false;\r\n\t}\r\n\r\n\tpublic function setTime(time:Float) {\r\n\t\tif (!_isLoaded || _snd == null || time > _snd.duration) return;\r\n\t\t_snd.currentTime = time;\r\n\t}\r\n\r\n\tpublic function getTime():Float {\r\n\t\tif (_snd == null || !_isLoaded || !_isPlaying) return 0;\r\n\t\treturn _snd.currentTime;\r\n\t}\r\n\r\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\r\n\t\t_options.onend = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function onLoad(callback:IWaudSound -> Void):IWaudSound {\r\n\t\t_options.onload = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function onError(callback:IWaudSound -> Void):IWaudSound {\r\n\t\t_options.onerror = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function destroy() {\r\n\t\tif (_snd != null) {\r\n\t\t\t_snd.pause();\r\n\t\t\t_snd.removeChild(_src);\r\n\t\t\t_src = null;\r\n\t\t\t_snd = null;\r\n\t\t}\r\n\t\t_isPlaying = false;\r\n\t}\r\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:noDoc\nclass HxOverrides {\n\n\tstatic function dateStr( date :Date ) : String {\n\t\tvar m = date.getMonth() + 1;\n\t\tvar d = date.getDate();\n\t\tvar h = date.getHours();\n\t\tvar mi = date.getMinutes();\n\t\tvar s = date.getSeconds();\n\t\treturn date.getFullYear()\n\t\t\t+\"-\"+(if( m < 10 ) \"0\"+m else \"\"+m)\n\t\t\t+\"-\"+(if( d < 10 ) \"0\"+d else \"\"+d)\n\t\t\t+\" \"+(if( h < 10 ) \"0\"+h else \"\"+h)\n\t\t\t+\":\"+(if( mi < 10 ) \"0\"+mi else \"\"+mi)\n\t\t\t+\":\"+(if( s < 10 ) \"0\"+s else \"\"+s);\n\t}\n\n\tstatic function strDate( s : String ) : Date {\n\t\tswitch( s.length ) {\n\t\tcase 8: // hh:mm:ss\n\t\t\tvar k = s.split(\":\");\n\t\t\tvar d : Date = untyped __new__(Date);\n\t\t\tuntyped d[\"setTime\"](0);\n\t\t\tuntyped d[\"setUTCHours\"](k[0]);\n\t\t\tuntyped d[\"setUTCMinutes\"](k[1]);\n\t\t\tuntyped d[\"setUTCSeconds\"](k[2]);\n\t\t\treturn d;\n\t\tcase 10: // YYYY-MM-DD\n\t\t\tvar k = s.split(\"-\");\n\t\t\treturn new Date(cast k[0],cast untyped k[1] - 1,cast k[2],0,0,0);\n\t\tcase 19: // YYYY-MM-DD hh:mm:ss\n\t\t\tvar k = s.split(\" \");\n\t\t\tvar y = k[0].split(\"-\");\n\t\t\tvar t = k[1].split(\":\");\n\t\t\treturn new Date(cast y[0],cast untyped y[1] - 1,cast y[2],cast t[0],cast t[1],cast t[2]);\n\t\tdefault:\n\t\t\tthrow \"Invalid date format : \" + s;\n\t\t}\n\t}\n\n\tstatic function cca( s : String, index : Int ) : Null<Int> {\n\t\tvar x = (cast s).charCodeAt(index);\n\t\tif( x != x ) // fast isNaN\n\t\t\treturn untyped undefined; // isNaN will still return true\n\t\treturn x;\n\t}\n\n\tstatic function substr( s : String, pos : Int, ?len : Int ) : String {\n\t\tif( pos != null && pos != 0 && len != null && len < 0 ) return \"\";\n\t\tif( len == null ) len = s.length;\n\t\tif( pos < 0 ){\n\t\t\tpos = s.length + pos;\n\t\t\tif( pos < 0 ) pos = 0;\n\t\t}else if( len < 0 ){\n\t\t\tlen = s.length + len - pos;\n\t\t}\n\n\t\treturn (untyped s).substr(pos, len);\n\t}\n\n\tstatic function indexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i < 0) {\n\t\t\ti += len;\n\t\t\tif (i < 0) i = 0;\n\t\t}\n\t\twhile (i < len)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function lastIndexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i >= len)\n\t\t\ti = len - 1;\n\t\telse if (i < 0)\n\t\t\ti += len;\n\t\twhile (i >= 0)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti--;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function remove<T>( a : Array<T>, obj : T ) {\n\t\tvar i = a.indexOf(obj);\n\t\tif( i == -1 ) return false;\n\t\ta.splice(i,1);\n\t\treturn true;\n\t}\n\n\tstatic function iter<T>( a : Array<T> ) : Iterator<T> untyped {\n\t\treturn {\n\t\t\tcur : 0,\n\t\t\tarr : a,\n\t\t\thasNext : function() {\n\t\t\t\treturn __this__.cur < __this__.arr.length;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\treturn __this__.arr[__this__.cur++];\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic function __init__() untyped {\n#if !js_es5\n\t\t__feature__('HxOverrides.indexOf', if( Array.prototype.indexOf ) __js__(\"HxOverrides\").indexOf = function(a,o,i) return Array.prototype.indexOf.call(a, o, i));\n\t\t__feature__('HxOverrides.lastIndexOf', if( Array.prototype.lastIndexOf ) __js__(\"HxOverrides\").lastIndexOf = function(a,o,i) return Array.prototype.lastIndexOf.call(a, o, i));\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class Reflect {\n\n\tpublic inline static function hasField( o : Dynamic, field : String ) : Bool {\n\t\treturn untyped __js__('Object').prototype.hasOwnProperty.call(o, field);\n\t}\n\n\tpublic static function field( o : Dynamic, field : String ) : Dynamic {\n\t\ttry return untyped o[field] catch( e : Dynamic ) return null;\n\t}\n\n\tpublic inline static function setField( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\to[field] = value;\n\t}\n\n\tpublic static inline function getProperty( o : Dynamic, field : String ) : Dynamic untyped {\n\t\tvar tmp;\n\t\treturn if( o == null ) __define_feature__(\"Reflect.getProperty\",null) else if( o.__properties__ && (tmp=o.__properties__[\"get_\"+field]) ) o[tmp]() else o[field];\n\t}\n\n\tpublic static inline function setProperty( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\tvar tmp;\n\t\tif( o.__properties__ && (tmp=o.__properties__[\"set_\"+field]) ) o[tmp](value) else o[field] = __define_feature__(\"Reflect.setProperty\",value);\n\t}\n\n\tpublic inline static function callMethod( o : Dynamic, func : haxe.Constraints.Function, args : Array<Dynamic> ) : Dynamic untyped {\n\t\treturn func.apply(o,args);\n\t}\n\n\tpublic static function fields( o : Dynamic ) : Array<String> {\n\t\tvar a = [];\n\t\tif (o != null) untyped {\n\t\t\tvar hasOwnProperty = __js__('Object').prototype.hasOwnProperty;\n\t\t\t__js__(\"for( var f in o ) {\");\n\t\t\tif( f != \"__id__\" && f != \"hx__closures__\" && hasOwnProperty.call(o, f) ) a.push(f);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static function isFunction( f : Dynamic ) : Bool untyped {\n\t\treturn __js__(\"typeof(f)\") == \"function\" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));\n\t}\n\n\tpublic static function compare<T>( a : T, b : T ) : Int {\n\t\treturn ( a == b ) ? 0 : (((cast a) > (cast b)) ? 1 : -1);\n\t}\n\n\tpublic static function compareMethods( f1 : Dynamic, f2 : Dynamic ) : Bool {\n\t\tif( f1 == f2 )\n\t\t\treturn true;\n\t\tif( !isFunction(f1) || !isFunction(f2) )\n\t\t\treturn false;\n\t\treturn f1.scope == f2.scope && f1.method == f2.method && f1.method != null;\n\t}\n\n\tpublic static function isObject( v : Dynamic ) : Bool untyped {\n\t\tif( v == null )\n\t\t\treturn false;\n\t\tvar t = __js__(\"typeof(v)\");\n\t\treturn (t == \"string\" || (t == \"object\" && v.__enum__ == null)) || (t == \"function\" && (js.Boot.isClass(v) || js.Boot.isEnum(v)) != null);\n\t}\n\n\tpublic static function isEnumValue( v : Dynamic ) : Bool {\n\t\treturn v != null && v.__enum__ != null;\n\t}\n\n\tpublic static function deleteField( o : Dynamic, field : String ) : Bool untyped {\n\t\tif( !hasField(o,field) ) return false;\n\t\t__js__(\"delete\")(o[field]);\n\t\treturn true;\n\t}\n\n\tpublic static function copy<T>( o : T ) : T {\n\t\tvar o2 : Dynamic = {};\n\t\tfor( f in Reflect.fields(o) )\n\t\t\tReflect.setField(o2,f,Reflect.field(o,f));\n\t\treturn o2;\n\t}\n\n\t@:overload(function( f : Array<Dynamic> -> Void ) : Dynamic {})\n\tpublic static function makeVarArgs( f : Array<Dynamic> -> Dynamic ) : Dynamic {\n\t\treturn function() {\n\t\t\tvar a = untyped Array.prototype.slice.call(__js__(\"arguments\"));\n\t\t\treturn f(a);\n\t\t};\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn (cast x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static inline function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn untyped x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if !js_es5\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static inline function getClass<T>( o : T ) : Class<T> {\n\t\treturn if (o == null) null else @:privateAccess js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\tif (a == null)\n\t\t\treturn null;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f:Dynamic = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"__meta__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\tvar a : Array<String> = untyped e.__constructs__;\n\t\treturn a.copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\treturn untyped e.__empty_constructs__;\n\t}\n\n}\n\n","import js.html.audio.AudioContext;\r\nimport js.html.HTMLDocument;\r\nimport js.html.AudioElement;\r\nimport js.Browser;\r\n\r\n/**\r\n* Web Audio Library with HTML5 audio fallback.\r\n*\r\n* @class Waud\r\n*/\r\n@:expose @:keep class Waud {\r\n\r\n\tstatic inline var PROBABLY:String = \"probably\";\r\n\tstatic inline var MAYBE:String = \"maybe\";\r\n\r\n\t/**\r\n\t* Version number.\r\n\t*\r\n\t* @property version\r\n\t* @static\r\n\t* @type {String}\r\n\t*/\r\n\tpublic static var version:String = \"0.5.1\";\r\n\r\n\t/**\r\n\t* Tells whether to use web audio api or not.\r\n\t*\r\n\t* You can use this to enable/disable web audio globally for all sounds.\r\n\t*\r\n\t* Note that you can also enable/disable web audio individually for each sound instance.\r\n\t*\r\n\t* @property useWebAudio\r\n\t* @static\r\n\t* @type {Bool}\r\n\t* @default true\r\n\t* @example\r\n \t*     Waud.useWebAudio = false;\r\n\t*/\r\n\tpublic static var useWebAudio:Bool = true;\r\n\r\n\t/**\r\n\t* Tells whether web audio api is supported or not.\r\n\t*\r\n\t* @property isWebAudioSupported\r\n\t* @static\r\n\t* @type {Bool}\r\n\t* @readOnly\r\n\t* @example\r\n \t*     Waud.isWebAudioSupported;\r\n\t*/\r\n\tpublic static var isWebAudioSupported(default, null):Bool;\r\n\r\n\t/**\r\n\t* Tells whether html5 audio is supported or not.\r\n\t*\r\n\t* @property isHTML5AudioSupported\r\n\t* @static\r\n\t* @type {Bool}\r\n\t* @readOnly\r\n\t* @example\r\n \t*     Waud.isHTML5AudioSupported;\r\n\t*/\r\n\tpublic static var isHTML5AudioSupported(default, null):Bool;\r\n\r\n\t/**\r\n\t* Defaults properties used on sound.\r\n\t*\r\n\t* @property defaults\r\n\t* @static\r\n\t* @type {WaudSoundOptions}\r\n\t* @default { autoplay: false, loop: false, preload: true, webaudio: true, volume: 1 }\r\n\t* @example\r\n \t*     Waud.defaults = { volume: 0.5, autoplay: true, preload: false };\r\n\t*/\r\n\tpublic static var defaults:WaudSoundOptions = {\r\n\t\tautoplay: false,\r\n\t\tloop: false,\r\n\t\tpreload: true,\r\n\t\twebaudio: true,\r\n\t\tvolume: 1\r\n\t};\r\n\r\n\t/**\r\n\t* Holds all the sounds that are loaded.\r\n\t*\r\n\t* @property sounds\r\n\t* @static\r\n\t* @type {Map<String, IWaudSound>}\r\n\t* @readOnly\r\n\t* @example\r\n \t*     Waud.sounds.get(\"url\");\r\n\t*/\r\n\tpublic static var sounds(default, null):Map<String, IWaudSound>;\r\n\r\n\t/**\r\n\t* Preferred sample rate used when creating buffer on audio context.\r\n\t*\r\n\t* It is recommended to use audio files with same sample rate and set the value used here.\r\n\t*\r\n\t* @property preferredSampleRate\r\n\t* @static\r\n\t* @type {Int}\r\n\t* @default 44100\r\n\t* @example\r\n \t*     Waud.preferredSampleRate = 22050;\r\n\t*/\r\n\tpublic static var preferredSampleRate:Int = 44100;\r\n\r\n\t/**\r\n\t* Audio Manager instance.\r\n\t*\r\n\t* @property audioManager\r\n\t* @static\r\n\t* @type {AudioManager}\r\n\t* @readOnly\r\n\t*/\r\n\tpublic static var audioManager(default, null):AudioManager;\r\n\r\n\t/**\r\n\t* Audio Context reference.\r\n\t*\r\n\t* @property audioContext\r\n\t* @static\r\n\t* @type {AudioContext}\r\n\t* @readOnly\r\n\t*/\r\n\tpublic static var audioContext:AudioContext;\r\n\r\n\t/**\r\n\t* Document dom element used for appending sounds and touch events.\r\n\t*\r\n\t* @property dom\r\n\t* @static\r\n\t* @type {document}\r\n\t*/\r\n\tpublic static var dom(default, null):HTMLDocument;\r\n\r\n\t/**\r\n\t* State of audio, muted or not.\r\n\t*\r\n\t* @property isMuted\r\n\t* @static\r\n\t* @type {Bool}\r\n\t* @readOnly\r\n\t* @default false\r\n\t* @example\r\n \t*     Waud.isMuted;\r\n\t*/\r\n\tpublic static var isMuted(default, null):Bool = false;\r\n\r\n\t/**\r\n\t* Touch unlock callback reference.\r\n\t*\r\n\t* @property __touchUnlockCallback\r\n\t* @static\r\n\t* @protected\r\n\t* @type {Function}\r\n\t*/\r\n\tpublic static var __touchUnlockCallback:Void -> Void;\r\n\r\n\t/**\r\n\t* Audio element used to check audio support.\r\n\t*\r\n\t* @property __audioElement\r\n\t* @static\r\n\t* @private\r\n\t* @type {AudioElement}\r\n\t* @readOnly\r\n\t*/\r\n\tstatic var __audioElement:AudioElement;\r\n\r\n\t/**\r\n\t* Focus Manager reference used for `autoMute` functionality.\r\n\t*\r\n\t* @property _focusManager\r\n\t* @static\r\n\t* @private\r\n\t* @type {WaudFocusManager}\r\n\t* @readOnly\r\n\t*/\r\n\tstatic var _focusManager:WaudFocusManager;\r\n\r\n\t/**\r\n\t* To initialise the library, make sure you call this first.\r\n\t*\r\n\t* You can also pass an optional parent DOM element to it where all the HTML5 sounds will be appended\r\n\t* and also used for touch events to unlock audio on iOS devices.\r\n\t*\r\n\t* @static\r\n\t* @method init\r\n\t* @param {HTMLDocument} [d = document]\r\n\t* @example\r\n \t*     Waud.init();\r\n\t*/\r\n\tpublic static function init(?d:HTMLDocument) {\r\n\t\tif (__audioElement == null) {\r\n\t\t\tif (d == null) d = Browser.document;\r\n\t\t\tdom = d;\r\n\t\t\t__audioElement = dom.createAudioElement();\r\n\t\t\tif (Waud.audioManager == null) Waud.audioManager = new AudioManager();\r\n\t\t\tisWebAudioSupported = Waud.audioManager.checkWebAudioAPISupport();\r\n\t\t\tisHTML5AudioSupported = (Reflect.field(Browser.window, \"Audio\") != null);\r\n\r\n\t\t\tif (isWebAudioSupported) audioContext = Waud.audioManager.createAudioContext();\r\n\r\n\t\t\tsounds = new Map();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Helper function to automatically mute audio when the browser window is not in focus.\r\n\t*\r\n\t* Will un-mute when the window gains focus.\r\n\t*\r\n\t* @static\r\n\t* @method autoMute\r\n\t* @example\r\n \t*     Waud.autoMute();\r\n\t*/\r\n\tpublic static function autoMute() {\r\n\t\tvar blur = function() {\r\n\t\t\tif (sounds != null) for (sound in sounds) sound.mute(true);\r\n\t\t};\r\n\r\n\t\tvar focus = function() {\r\n\t\t\tif (!isMuted && sounds != null) for (sound in sounds) sound.mute(false);\r\n\t\t};\r\n\r\n\t\t_focusManager = new WaudFocusManager();\r\n\t\t_focusManager.focus = focus;\r\n\t\t_focusManager.blur = blur;\r\n\t}\r\n\r\n\t/**\r\n\t* Helper function to unlock audio on iOS devices.\r\n\t*\r\n\t* You can pass an optional callback which will be triggered after unlocking audio.\r\n\t*\r\n\t* @static\r\n\t* @method enableTouchUnlock\r\n\t* @param {Function} [callback] - Optional callback that triggers after unlocking audio.\r\n\t* @example\r\n \t*     Waud.enableTouchUnlock(callback);\r\n\t*/\r\n\tpublic static function enableTouchUnlock(?callback:Void -> Void) {\r\n\t\t__touchUnlockCallback = callback;\r\n\t\tdom.ontouchend = Waud.audioManager.unlockAudio;\r\n\t}\r\n\r\n\t/**\r\n\t* Helper function to mute all the sounds.\r\n\t*\r\n\t* @static\r\n\t* @method mute\r\n\t* @param {Bool} [val = true]\r\n\t* @example\r\n\t*     Waud.mute();\r\n \t*     Waud.mute(true);\r\n \t*     Waud.mute(false);\r\n\t*/\r\n\tpublic static function mute(?val:Bool = true) {\r\n\t\tisMuted = val;\r\n\t\tif (sounds != null) for (sound in sounds) sound.mute(val);\r\n\t}\r\n\r\n\t/**\r\n\t* Helper function to stop all the sounds.\r\n\t*\r\n\t* @static\r\n\t* @method stop\r\n\t* @example\r\n\t*     Waud.stop();\r\n\t*/\r\n\tpublic static function stop() {\r\n\t\tif (sounds != null) for (sound in sounds) sound.stop();\r\n\t}\r\n\r\n\t/**\r\n\t* Helper function to pause all the sounds.\r\n\t*\r\n\t* @static\r\n\t* @method pause\r\n\t* @example\r\n\t*     Waud.pause();\r\n\t*/\r\n\tpublic static function pause() {\r\n\t\tif (sounds != null) for (sound in sounds) sound.pause();\r\n\t}\r\n\r\n\t/**\r\n\t* Returns a string with all the format support information.\r\n\t*\r\n\t* @static\r\n\t* @method getFormatSupportString\r\n\t* @return {String} support string `OGG: probably, WAV: probably, MP3: probably, AAC: probably, M4A: maybe` (example)\r\n\t* @example\r\n\t*     Waud.getFormatSupportString();\r\n\t*/\r\n\tpublic static function getFormatSupportString():String {\r\n\t\tvar support:String = \"OGG: \" + __audioElement.canPlayType('audio/ogg; codecs=\"vorbis\"');\r\n\t\tsupport += \", WAV: \" + __audioElement.canPlayType('audio/wav; codecs=\"1\"');\r\n\t\tsupport += \", MP3: \" + __audioElement.canPlayType('audio/mpeg;');\r\n\t\tsupport += \", AAC: \" + __audioElement.canPlayType('audio/aac;');\r\n\t\tsupport += \", M4A: \" + __audioElement.canPlayType('audio/x-m4a;');\r\n\t\treturn support;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check whether audio is supported or not.\r\n\t*\r\n\t* @static\r\n\t* @method isSupported\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isSupported();\r\n\t*/\r\n\tpublic static function isSupported():Bool {\r\n\t\tif (isWebAudioSupported == null || isHTML5AudioSupported == null) {\r\n\t\t\tisWebAudioSupported = Waud.audioManager.checkWebAudioAPISupport();\r\n\t\t\tisHTML5AudioSupported = (Reflect.field(Browser.window, \"Audio\") != null);\r\n\t\t}\r\n\t\treturn (isWebAudioSupported || isHTML5AudioSupported);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check `ogg` format support.\r\n\t*\r\n\t* @static\r\n\t* @method isOGGSupported\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isOGGSupported();\r\n\t*/\r\n\tpublic static function isOGGSupported():Bool {\r\n\t\tvar canPlay = __audioElement.canPlayType('audio/ogg; codecs=\"vorbis\"');\r\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == PROBABLY || canPlay == MAYBE));\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check `wav` format support.\r\n\t*\r\n\t* @static\r\n\t* @method isWAVSupported\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isWAVSupported();\r\n\t*/\r\n\tpublic static function isWAVSupported():Bool {\r\n\t\tvar canPlay = __audioElement.canPlayType('audio/wav; codecs=\"1\"');\r\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == PROBABLY || canPlay == MAYBE));\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check `mp3` format support.\r\n\t*\r\n\t* @static\r\n\t* @method isMP3Supported\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isMP3Supported();\r\n\t*/\r\n\tpublic static function isMP3Supported():Bool {\r\n\t\tvar canPlay = __audioElement.canPlayType('audio/mpeg;');\r\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == PROBABLY || canPlay == MAYBE));\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check `aac` format support.\r\n\t*\r\n\t* @static\r\n\t* @method isAACSupported\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isAACSupported();\r\n\t*/\r\n\tpublic static function isAACSupported():Bool {\r\n\t\tvar canPlay = __audioElement.canPlayType('audio/aac;');\r\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == PROBABLY || canPlay == MAYBE));\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check `m4a` format support.\r\n\t*\r\n\t* @static\r\n\t* @method isM4ASupported\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isM4ASupported();\r\n\t*/\r\n\tpublic static function isM4ASupported():Bool {\r\n\t\tvar canPlay = __audioElement.canPlayType('audio/x-m4a;');\r\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == PROBABLY || canPlay == MAYBE));\r\n\t}\r\n\r\n\t/**\r\n\t* Function to destroy audio context.\r\n\t*\r\n\t* @static\r\n\t* @method destroy\r\n\t* @example\r\n\t*     Waud.destroy();\r\n\t*/\r\n\tpublic static function destroy() {\r\n\t\tif (sounds != null) for (sound in sounds) sound.destroy();\r\n\t\tsounds = null;\r\n\t\tif (Waud.audioManager != null) Waud.audioManager.destroy();\r\n\t\tWaud.audioManager = null;\r\n\t\tWaud.audioContext = null;\r\n\t\t__audioElement = null;\r\n\t\tif (_focusManager != null) {\r\n\t\t\t_focusManager.clearEvents();\r\n\t\t\t_focusManager.blur = null;\r\n\t\t\t_focusManager.focus = null;\r\n\t\t}\r\n\t}\r\n}","import js.Browser;\r\n\r\n@:expose @:keep class WaudFocusManager {\r\n\r\n\tstatic inline var FOCUS_STATE:String = \"focus\";\r\n\tstatic inline var BLUR_STATE:String = \"blur\";\r\n\tstatic inline var ON_FOCUS:String = \"onfocus\";\r\n\tstatic inline var ON_BLUR:String = \"onblur\";\r\n\tstatic inline var PAGE_SHOW:String = \"pageshow\";\r\n\tstatic inline var PAGE_HIDE:String = \"pagehide\";\r\n\tstatic inline var WINDOW:String = \"window\";\r\n\tstatic inline var DOCUMENT:String = \"document\";\r\n\r\n\t/**\r\n\t* Focus callback function.\r\n\t*\r\n\t* @property focus\r\n\t* @type {Function}\r\n\t* @example\r\n \t*     fm.focus = onFocus;\r\n\t*/\r\n\tpublic var focus:Void -> Void;\r\n\r\n\t/**\r\n\t* Blur callback function.\r\n\t*\r\n\t* @property blur\r\n\t* @type {Function}\r\n\t* @example\r\n \t*     fm.blur = onBlur;\r\n\t*/\r\n\tpublic var blur:Void -> Void;\r\n\r\n\tvar _hidden:String;\r\n\tvar _visibilityChange:String;\r\n\tvar _currentState:String;\r\n\r\n\t/**\r\n\t* Cross-browser utility class used to mute/unmute audio on focus on/off events. Used when **Waud.autoMute()** is called.\r\n\t*\r\n\t* This can also be used as a standalone utility class to handle focus on/off events.\r\n\t*\r\n\t* @class WaudFocusManager\r\n\t* @constructor\r\n\t* @example\r\n\t* \t\tvar fm = new WaudFocusManager();\r\n\t* \t\tfm.focus = onFocus;\r\n\t* \t\tfm.blur = onBlur;\r\n\t*/\r\n\tpublic function new() {\r\n\t\t_hidden = \"\";\r\n\t\t_visibilityChange = \"\";\r\n\t\t_currentState = \"\";\r\n\r\n\t\tif (Reflect.field(Browser.document, \"hidden\") != null) {\r\n\t\t\t_hidden = \"hidden\";\r\n\t\t\t_visibilityChange = \"visibilitychange\";\r\n\t\t}\r\n\t\telse if (Reflect.field(Browser.document, \"mozHidden\") != null) {\r\n\t\t\t_hidden = \"mozHidden\";\r\n\t\t\t_visibilityChange = \"mozvisibilitychange\";\r\n\t\t}\r\n\t\telse if (Reflect.field(Browser.document, \"msHidden\") != null) {\r\n\t\t\t_hidden = \"msHidden\";\r\n\t\t\t_visibilityChange = \"msvisibilitychange\";\r\n\t\t}\r\n\t\telse if (Reflect.field(Browser.document, \"webkitHidden\") != null) {\r\n\t\t\t_hidden = \"webkitHidden\";\r\n\t\t\t_visibilityChange = \"webkitvisibilitychange\";\r\n\t\t}\r\n\r\n\t\tif (Reflect.field(Browser.window, \"addEventListener\") != null) {\r\n\t\t\tuntyped __js__(WINDOW).addEventListener(FOCUS_STATE, _focus);\r\n\t\t\tuntyped __js__(WINDOW).addEventListener(BLUR_STATE, _blur);\r\n\t\t\tuntyped __js__(WINDOW).addEventListener(PAGE_SHOW, _focus);\r\n\t\t\tuntyped __js__(WINDOW).addEventListener(PAGE_HIDE, _blur);\r\n\t\t\tuntyped __js__(DOCUMENT).addEventListener(_visibilityChange, _handleVisibilityChange);\r\n\t\t}\r\n\t\telse if (Reflect.field(Browser.window, \"attachEvent\") != null) {\r\n\t\t\tuntyped __js__(WINDOW).attachEvent(ON_FOCUS, _focus);\r\n\t\t\tuntyped __js__(WINDOW).attachEvent(ON_BLUR, _blur);\r\n\t\t\tuntyped __js__(WINDOW).attachEvent(PAGE_SHOW, _focus);\r\n\t\t\tuntyped __js__(WINDOW).attachEvent(PAGE_HIDE, _blur);\r\n\t\t\tuntyped __js__(DOCUMENT).attachEvent(_visibilityChange, _handleVisibilityChange);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tBrowser.window.onload = function () {\r\n\t\t\t\tBrowser.window.onfocus = _focus;\r\n\t\t\t\tBrowser.window.onblur = _blur;\r\n\t\t\t\tBrowser.window.onpageshow = _focus;\r\n\t\t\t\tBrowser.window.onpagehide = _blur;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Function to handle visibility change event.\r\n\t*\r\n\t* @private\r\n\t* @method _handleVisibilityChange\r\n\t*/\r\n\tfunction _handleVisibilityChange() {\r\n\t\tif (Reflect.field(Browser.document, _hidden) != null && Reflect.field(Browser.document, _hidden) && blur != null) blur();\r\n\t\telse if (focus != null) focus();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to trigger focus callback.\r\n\t*\r\n\t* @private\r\n\t* @method _focus\r\n\t*/\r\n\tfunction _focus() {\r\n\t\tif (_currentState != FOCUS_STATE && focus != null) focus();\r\n\t\t_currentState = FOCUS_STATE;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to trigger blur callback.\r\n\t*\r\n\t* @private\r\n\t* @method _blur\r\n\t*/\r\n\tfunction _blur() {\r\n\t\tif (_currentState != BLUR_STATE && blur != null) blur();\r\n\t\t_currentState = BLUR_STATE;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to clear focus manager events.\r\n\t*\r\n\t* @method clearEvents\r\n\t* @example\r\n\t*     fm.clearEvents();\r\n\t*/\r\n\tpublic function clearEvents() {\r\n\t\tif (Reflect.field(Browser.window, \"removeEventListener\") != null) {\r\n\t\t\tuntyped __js__(WINDOW).removeEventListener(FOCUS_STATE, _focus);\r\n\t\t\tuntyped __js__(WINDOW).removeEventListener(BLUR_STATE, _blur);\r\n\t\t\tuntyped __js__(WINDOW).removeEventListener(PAGE_SHOW, _focus);\r\n\t\t\tuntyped __js__(WINDOW).removeEventListener(PAGE_HIDE, _blur);\r\n\t\t\tuntyped __js__(WINDOW).removeEventListener(_visibilityChange, _handleVisibilityChange);\r\n\t\t}\r\n\t\telse if (Reflect.field(Browser.window, \"removeEvent\") != null) {\r\n\t\t\tuntyped __js__(WINDOW).removeEvent(ON_FOCUS, _focus);\r\n\t\t\tuntyped __js__(WINDOW).removeEvent(ON_BLUR, _blur);\r\n\t\t\tuntyped __js__(WINDOW).removeEvent(PAGE_SHOW, _focus);\r\n\t\t\tuntyped __js__(WINDOW).removeEvent(PAGE_HIDE, _blur);\r\n\t\t\tuntyped __js__(WINDOW).removeEvent(_visibilityChange, _handleVisibilityChange);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tBrowser.window.onfocus = null;\r\n\t\t\tBrowser.window.onblur = null;\r\n\t\t\tBrowser.window.onpageshow = null;\r\n\t\t\tBrowser.window.onpagehide = null;\r\n\t\t}\r\n\t}\r\n}","import js.html.XMLHttpRequest;\r\nimport haxe.Json;\r\n\r\n@:expose @:keep class WaudSound implements IWaudSound {\r\n\r\n\t/**\r\n\t* Indicates if the sound is sprite sound or normal sound.\r\n\t*\r\n\t* @property isSpriteSound\r\n\t* @type {Bool}\r\n\t* @readOnly\r\n\t* @example\r\n \t*     snd.isSpriteSound;\r\n\t*/\r\n\tpublic var isSpriteSound:Bool;\r\n\r\n\t/**\r\n\t* Duration of the sound.\r\n\t*\r\n\t* @property duration\r\n\t* @type {Float}\r\n\t* @readOnly\r\n\t* @example\r\n \t*     snd.duration;\r\n\t*/\r\n\tpublic var duration(get, null):Float;\r\n\r\n\t/**\r\n\t* Sound url.\r\n\t*\r\n\t* @property url\r\n\t* @type {String}\r\n\t* @readOnly\r\n\t* @example\r\n \t*     snd.url;\r\n\t*/\r\n\tpublic var url:String;\r\n\r\n\tvar _snd:IWaudSound;\r\n\tvar _options:WaudSoundOptions;\r\n\tvar _spriteData:AudioSprite;\r\n\r\n\t/**\r\n\t* Class to automatically use web audio api with HTML5 audio fallback.\r\n\t*\r\n\t* @class WaudSound\r\n\t* @constructor\r\n\t* @param {String} url - Can be audio file path or JSON file for audio sprite.\r\n\t* @param {WaudSoundOptions} [options] - Sound options.\r\n\t* @example\r\n\t* \t\t// MP3 Sound\r\n\t* \t\tvar snd = new WaudSound(\"assets/loop.mp3\", { autoplay: false, loop: true, volume: 0.5 });\r\n\t*\r\n\t* \t\t// Force HTML5 Audio\r\n\t* \t\tvar snd = new WaudSound(\"assets/loop.mp3\", { webaudio: false });\r\n\t*\r\n\t* \t\t// Audio Sprite\r\n\t* \t\tvar audSprite = new WaudSound(\"assets/sprite.json\");\r\n\t* \t\taudSprite.play(\"glass\");\r\n\t*/\r\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\r\n\t\tif (Waud.audioManager == null) {\r\n\t\t\ttrace(\"initialise Waud using Waud.init() before loading sounds\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_options = options;\r\n\r\n\t\tif (url.indexOf(\".json\") > 0) {\r\n\t\t\tisSpriteSound = true;\r\n\t\t\t_loadSpriteJson(url);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tisSpriteSound = false;\r\n\t\t\t_init(url);\r\n\t\t}\r\n\r\n\t\tWaud.sounds.set(url, this);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to load audio sprite JSON.\r\n\t*\r\n\t* @private\r\n\t* @method _loadSpriteJson\r\n\t* @param {String} url - Audio Sprite JSON path.\r\n\t*/\r\n\tfunction _loadSpriteJson(jsonUrl:String) {\r\n\t\tvar xobj = new XMLHttpRequest();\r\n\t\txobj.overrideMimeType(\"application/json\");\r\n\t\txobj.open(\"GET\", jsonUrl, true);\r\n\t\txobj.onreadystatechange = function() {\r\n\t\t\tif (xobj.readyState == 4 && xobj.status == 200) {\r\n\t\t\t\t_spriteData = Json.parse(xobj.response);\r\n\t\t\t\t_init(_spriteData.src);\r\n\t\t\t}\r\n\t\t};\r\n\t\txobj.send(null);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to initialize sound.\r\n\t*\r\n\t* @private\r\n\t* @method _init\r\n\t* @param {String} url - Audio file path.\r\n\t*/\r\n\tfunction _init(soundUrl:String) {\r\n\t\turl = soundUrl;\r\n\t\tif (Waud.isWebAudioSupported && Waud.useWebAudio && (_options == null || _options.webaudio == null || _options.webaudio)) {\r\n\t\t\t_snd = new WebAudioAPISound(url, _options);\r\n\t\t}\r\n\t\telse if (Waud.isHTML5AudioSupported) {\r\n\t\t\t_snd = new HTML5Sound(url, _options);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttrace(\"no audio support in this browser\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t_snd.isSpriteSound = isSpriteSound;\r\n\t}\r\n\r\n\tfunction get_duration():Float {\r\n\t\tif (_snd == null) return 0;\r\n\t\treturn _snd.duration;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to set sound volume.\r\n\t*\r\n\t* @method setVolume\r\n\t* @param {Float} val - Should be between 0 and 1.\r\n\t* @example\r\n\t*     snd.setVolume(0.5);\r\n\t*/\r\n\tpublic function setVolume(val:Float) {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.setVolume(val);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to get sound volume.\r\n\t*\r\n\t* @method getVolume\r\n\t* @return {Float} between 0 and 1\r\n\t* @example\r\n\t*     snd.getVolume();\r\n\t*/\r\n\tpublic function getVolume():Float {\r\n\t\tif (_snd == null) return 0;\r\n\t\treturn _snd.getVolume();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to mute sound.\r\n\t*\r\n\t* @method mute\r\n\t* @param {Bool} val\r\n\t* @example\r\n\t*     snd.mute(true);\r\n\t*/\r\n\tpublic function mute(val:Bool) {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.mute(val);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to automatically mute or unmute the sound.\r\n\t*\r\n\t* @method toggleMute\r\n\t* @example\r\n\t*     snd.toggleMute();\r\n\t*/\r\n\tpublic function toggleMute() {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.toggleMute();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to manually load the sound if `preload` was set to `false` with optional onload callback.\r\n\t*\r\n\t* @method load\r\n\t* @param {Function} [callback] - onload callback function.\r\n\t* @return {IWaudSound} sound instance\r\n\t* @example\r\n\t*     snd.load();\r\n\t*     snd.load(callback);\r\n\t*/\r\n\tpublic function load(?callback:IWaudSound -> Void):IWaudSound {\r\n\t\tif (_snd == null) return null;\r\n\t\t_snd.load(callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to play the sound with optional sprite name when using audio sprite.\r\n\t*\r\n\t* @method play\r\n\t* @param {String} [spriteName] - Sprite name to play.\r\n\t* @return {Int} sound id\r\n\t* @example\r\n\t*     snd.play();\r\n\t*     snd.play(\"bell\");\r\n\t*/\r\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties = null):Int {\r\n\t\tif (_snd == null) return null;\r\n\t\tif (spriteName != null) {\r\n\t\t\tfor (snd in _spriteData.sprite) {\r\n\t\t\t\tif (snd.name == spriteName) {\r\n\t\t\t\t\tsoundProps = snd;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (soundProps == null) return null;\r\n\t\t}\r\n\t\treturn _snd.play(spriteName, soundProps);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to automatically pause or play the sound.\r\n\t*\r\n\t* @method togglePlay\r\n\t* @example\r\n\t*     snd.togglePlay();\r\n\t*/\r\n\tpublic function togglePlay() {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.togglePlay();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the sound is playing or not.\r\n\t*\r\n\t* @method isPlaying\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     snd.isPlaying();\r\n\t*/\r\n\tpublic function isPlaying():Bool {\r\n\t\tif (_snd == null) return false;\r\n\t\treturn _snd.isPlaying();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to loop or unloop sound.\r\n\t*\r\n\t* @method loop\r\n\t* @param {Bool} val\r\n\t* @example\r\n\t*     snd.loop(true);\r\n\t*/\r\n\tpublic function loop(val:Bool) {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.loop(val);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to stop sound.\r\n\t*\r\n\t* @method stop\r\n\t* @example\r\n\t*     snd.stop();\r\n\t*/\r\n\tpublic function stop() {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.stop();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to pause sound.\r\n\t*\r\n\t* @method pause\r\n\t* @example\r\n\t*     snd.pause();\r\n\t*/\r\n\tpublic function pause() {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.pause();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to set playback position in seconds.\r\n\t*\r\n\t* **Not supported for audio sprites yet.**\r\n\t*\r\n\t* @method setTime\r\n\t* @param {Float} time - playback position in seconds.\r\n\t* @example\r\n\t*     snd.setTime(30);\r\n\t*/\r\n\tpublic function setTime(time:Float) {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.setTime(time);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to get the current playback position in seconds.\r\n\t*\r\n\t* **Not supported for audio sprites yet.**\r\n\t*\r\n\t* @method getTime\r\n\t* @example\r\n\t*     snd.getTime();\r\n\t*/\r\n\tpublic function getTime():Float {\r\n\t\tif (_snd == null) return 0;\r\n\t\treturn _snd.getTime();\r\n\t}\r\n\r\n\t/**\r\n\t* Function to add callback that triggers when the sound finishes playing.\r\n\t*\r\n\t* @method onEnd\r\n\t* @param {Function} callback - Callback function.\r\n\t* @return {IWaudSound} sound instance\r\n\t* @example\r\n\t*     snd.onEnd(callback);\r\n\t*/\r\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\r\n\t\tif (_snd == null) return null;\r\n\t\t_snd.onEnd(callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to add callback that triggers when the sound is loaded.\r\n\t*\r\n\t* @method onLoad\r\n\t* @param {Function} callback - Callback function.\r\n\t* @return {IWaudSound} sound instance\r\n\t* @example\r\n\t*     snd.onLoad(callback);\r\n\t*/\r\n\tpublic function onLoad(callback:IWaudSound -> Void):IWaudSound {\r\n\t\tif (_snd == null) return null;\r\n\t\t_snd.onLoad(callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to add callback that triggers when the sound fails to load or if it fails to decode when using web audio.\r\n\t*\r\n\t* @method onError\r\n\t* @param {Function} callback - Callback function.\r\n\t* @return {IWaudSound} sound instance\r\n\t* @example\r\n\t*     snd.onError(callback);\r\n\t*/\r\n\tpublic function onError(callback:IWaudSound -> Void):IWaudSound {\r\n\t\tif (_snd == null) return null;\r\n\t\t_snd.onError(callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to destroy sound.\r\n\t*\r\n\t* @method destroy\r\n\t* @example\r\n\t*     snd.destroy();\r\n\t*/\r\n\tpublic function destroy() {\r\n\t\tif (_snd == null) return;\r\n\t\t_snd.destroy();\r\n\t\t_snd = null;\r\n\t}\r\n}","import js.Browser;\r\n\r\n/**\r\n* Collection of Browser Utility Functions.\r\n*\r\n* @class WaudUtils\r\n*/\r\n@:expose @:keep class WaudUtils {\r\n\r\n\t/**\r\n\t* Function to check if the device is **Android** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isAndroid\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isAndroid();\r\n\t*/\r\n\tpublic static function isAndroid(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/Android/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **iOS** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isiOS\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isiOS();\r\n\t*/\r\n\tpublic static function isiOS(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/(iPad|iPhone|iPod)/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **Windows Phone** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isWindowsPhone\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isWindowsPhone();\r\n\t*/\r\n\tpublic static function isWindowsPhone(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/(IEMobile|Windows Phone)/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **Firefox** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isFirefox\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isFirefox();\r\n\t*/\r\n\tpublic static function isFirefox(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/Firefox/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **Opera** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isOpera\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isOpera();\r\n\t*/\r\n\tpublic static function isOpera(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/Opera/i.match(ua) || Reflect.field(Browser.window, \"opera\") != null;\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **Chrome** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isChrome\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isChrome();\r\n\t*/\r\n\tpublic static function isChrome(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/Chrome/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **Safari** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isSafari\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isSafari();\r\n\t*/\r\n\tpublic static function isSafari(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/Safari/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to check if the device is **mobile** or not.\r\n\t*\r\n\t* @static\r\n\t* @method isMobile\r\n\t* @return {Bool} true or false\r\n\t* @example\r\n\t*     Waud.isMobile();\r\n\t*/\r\n\tpublic static function isMobile(?ua:String):Bool {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\treturn ~/(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone|IEMobile)/i.match(ua);\r\n\t}\r\n\r\n\t/**\r\n\t* Function to get the **iOS** version.\r\n\t*\r\n\t* @static\r\n\t* @method getiOSVersion\r\n\t* @return {Array<Int>} [9,0,1]\r\n\t* @example\r\n\t*     Waud.getiOSVersion();\r\n\t*/\r\n\tpublic static function getiOSVersion(?ua:String):Array<Int> {\r\n\t\tif (ua == null) ua = Browser.navigator.userAgent;\r\n\t\tvar v:EReg = ~/[0-9_]+?[0-9_]+?[0-9_]+/i;\r\n\t\tvar matched:Array<Int> = [];\r\n\t\tif (v.match(ua)) {\r\n\t\t\tvar match:Array<String> = v.matched(0).split(\"_\");\r\n\t\t\tmatched = [for (i in match) Std.parseInt(i)];\r\n\t\t}\r\n\t\treturn matched;\r\n\t}\r\n}","import js.html.XMLHttpRequestResponseType;\r\nimport js.html.XMLHttpRequest;\r\nimport js.html.audio.GainNode;\r\nimport js.html.audio.AudioBufferSourceNode;\r\nimport js.html.audio.AudioBuffer;\r\n\r\n@:keep class WebAudioAPISound extends BaseSound implements IWaudSound {\r\n\r\n\tvar _srcNodes:Array<AudioBufferSourceNode>;\r\n\tvar _gainNodes:Array<Dynamic>;\r\n\tvar _manager:AudioManager;\r\n\tvar _snd:AudioBufferSourceNode;\r\n\tvar _gainNode:GainNode;\r\n\tvar _playStartTime:Float;\r\n\tvar _pauseTime:Float;\r\n\tvar _currentSoundProps:AudioSpriteSoundProperties;\r\n\r\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\r\n\t\tsuper(url, options);\r\n\t\t_playStartTime = 0;\r\n\t\t_pauseTime = 0;\r\n\t\t_srcNodes = [];\r\n\t\t_gainNodes = [];\r\n\t\t_currentSoundProps = null;\r\n\t\t_manager = Waud.audioManager;\r\n\t\tif (_options.preload) load();\r\n\t}\r\n\r\n\tfunction _onSoundLoaded(evt) {\r\n\t\t_manager.audioContext.decodeAudioData(evt.target.response, _decodeSuccess, _error);\r\n\t}\r\n\r\n\tfunction _decodeSuccess(buffer:AudioBuffer) {\r\n\t\tif (buffer == null) {\r\n\t\t\ttrace(\"empty buffer: \" + url);\r\n\t\t\t_error();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t_manager.bufferList.set(url, buffer);\r\n\t\t_isLoaded = true;\r\n\t\tduration = buffer.duration;\r\n\t\tif (_options.onload != null) _options.onload(this);\r\n\t\tif (_options.autoplay) play();\r\n\t}\r\n\r\n\tinline function _error() {\r\n\t\tif (_options.onerror != null) _options.onerror(this);\r\n\t}\r\n\r\n\tfunction _makeSource(buffer:AudioBuffer):AudioBufferSourceNode {\r\n\t\tvar source:AudioBufferSourceNode = _manager.audioContext.createBufferSource();\r\n\t\tsource.buffer = buffer;\r\n\t\tif (untyped __js__(\"this._manager.audioContext\").createGain != null) _gainNode = _manager.audioContext.createGain();\r\n\t\telse _gainNode = untyped __js__(\"this._manager.audioContext\").createGainNode();\r\n\t\tsource.connect(_gainNode);\r\n\t\t_gainNode.connect(_manager.audioContext.destination);\r\n\t\t_srcNodes.push(source);\r\n\t\t_gainNodes.push(_gainNode);\r\n\t\treturn source;\r\n\t}\r\n\r\n\toverride function get_duration():Float {\r\n\t\tif (!_isLoaded) return 0;\r\n\t\treturn duration;\r\n\t}\r\n\r\n\tpublic function load(?callback:IWaudSound -> Void):IWaudSound {\r\n\t\tif (!_isLoaded) {\r\n\t\t\tvar request = new XMLHttpRequest();\r\n\t\t\trequest.open(\"GET\", url, true);\r\n\t\t\trequest.responseType = XMLHttpRequestResponseType.ARRAYBUFFER;\r\n\t\t\trequest.onload = _onSoundLoaded;\r\n\t\t\trequest.onerror = _error;\r\n\t\t\trequest.send();\r\n\r\n\t\t\tif (callback != null) _options.onload = callback;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties):Int {\r\n\t\tif (_isPlaying) return _srcNodes.indexOf(_snd);\r\n\t\tif (!_isLoaded) {\r\n\t\t\ttrace(\"sound not loaded\");\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tif (_muted) return -1;\r\n\t\tvar start:Float = 0;\r\n\t\tvar end:Float = -1;\r\n\t\tif (isSpriteSound && soundProps != null) {\r\n\t\t\t_currentSoundProps = soundProps;\r\n\t\t\tstart = soundProps.start + _pauseTime;\r\n\t\t\tend = soundProps.duration;\r\n\t\t}\r\n\t\tvar buffer = _manager.bufferList.get(url);\r\n\t\tif (buffer != null) {\r\n\t\t\t_snd = _makeSource(buffer);\r\n\t\t\tif (start >= 0 && end > -1) {\r\n\t\t\t\tif (Reflect.field(_snd, \"start\") != null) _snd.start(0, start, end);\r\n\t\t\t\telse {\r\n\t\t\t\t\tuntyped __js__(\"this._snd\").noteGrainOn(0, start, end);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t_snd.loop = _options.loop;\r\n\t\t\t\tif (Reflect.field(_snd, \"start\") != null) _snd.start(0, _pauseTime, _snd.buffer.duration);\r\n\t\t\t\telse untyped __js__(\"this._snd\").noteGrainOn(0, _pauseTime, _snd.buffer.duration);\r\n\t\t\t}\r\n\r\n\t\t\t_playStartTime = _manager.audioContext.currentTime;\r\n\t\t\t_isPlaying = true;\r\n\t\t\t_snd.onended = function() {\r\n\t\t\t\t_pauseTime = 0;\r\n\t\t\t\t_isPlaying = false;\r\n\t\t\t\tif (isSpriteSound && soundProps != null && soundProps.loop != null && soundProps.loop && start >= 0 && end > -1) {\r\n\t\t\t\t\tplay(spriteName, soundProps);\r\n\t\t\t\t}\r\n\t\t\t\tif (_options.onend != null) _options.onend(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\t_gainNode.gain.value = _options.volume;\r\n\r\n\t\treturn _srcNodes.indexOf(_snd);\r\n\t}\r\n\r\n\tpublic function togglePlay() {\r\n\t\tif (_isPlaying) pause();\r\n\t\telse play();\r\n\t}\r\n\r\n\tpublic function isPlaying():Bool {\r\n\t\treturn _isPlaying;\r\n\t}\r\n\r\n\tpublic function loop(val:Bool) {\r\n\t\tif (_snd == null || !_isLoaded) return;\r\n\t\t_snd.loop = val;\r\n\t}\r\n\r\n\tpublic function setVolume(val:Float) {\r\n\t\t_options.volume = val;\r\n\t\tif (_gainNode == null || !_isLoaded) return;\r\n\t\t_gainNode.gain.value = _options.volume;\r\n\t}\r\n\r\n\tpublic function getVolume():Float {\r\n\t\treturn _options.volume;\r\n\t}\r\n\r\n\tpublic function mute(val:Bool) {\r\n\t\t_muted = val;\r\n\t\tif (_gainNode == null || !_isLoaded) return;\r\n\t\tif (val) _gainNode.gain.value = 0;\r\n\t\telse _gainNode.gain.value = _options.volume;\r\n\t}\r\n\r\n\tpublic function toggleMute() {\r\n\t\tmute(!_muted);\r\n\t}\r\n\r\n\tpublic function stop() {\r\n\t\t_pauseTime = 0;\r\n\t\tif (_snd == null || !_isLoaded || !_isPlaying) return;\r\n\t\tdestroy();\r\n\t}\r\n\r\n\tpublic function pause() {\r\n\t\tif (_snd == null || !_isLoaded || !_isPlaying) return;\r\n\t\tdestroy();\r\n\t\t_pauseTime += _manager.audioContext.currentTime - _playStartTime;\r\n\t}\r\n\r\n\tpublic function setTime(time:Float) {\r\n\t\tif (!_isLoaded || time > duration) return;\r\n\r\n\t\tif (_isPlaying) {\r\n\t\t\tstop();\r\n\t\t\t_pauseTime = time;\r\n\t\t\tplay();\r\n\t\t}\r\n\t\telse _pauseTime = time;\r\n\t}\r\n\r\n\tpublic function getTime():Float {\r\n\t\tif (_snd == null || !_isLoaded || !_isPlaying) return 0;\r\n\t\treturn _manager.audioContext.currentTime - _playStartTime + _pauseTime;\r\n\t}\r\n\r\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\r\n\t\t_options.onend = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function onLoad(callback:IWaudSound -> Void):IWaudSound {\r\n\t\t_options.onload = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function onError(callback:IWaudSound -> Void):IWaudSound {\r\n\t\t_options.onerror = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic function destroy() {\r\n\t\tfor (src in _srcNodes) {\r\n\t\t\tif (Reflect.field(src, \"stop\") != null) src.stop(0);\r\n\t\t\telse if (Reflect.field(src, \"noteOff\") != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tuntyped __js__(\"this.src\").noteOff(0);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e:Dynamic) {}\r\n\t\t\t}\r\n\t\t\tsrc.disconnect();\r\n\t\t\tsrc = null;\r\n\t\t}\r\n\t\tfor (gain in _gainNodes) {\r\n\t\t\tgain.disconnect();\r\n\t\t\tgain = null;\r\n\t\t}\r\n\t\t_srcNodes = [];\r\n\t\t_gainNodes = [];\r\n\r\n\t\t_isPlaying = false;\r\n\t}\r\n}","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Timer class allows you to create asynchronous timers on platforms that\n\tsupport events.\n\n\tThe intended usage is to create an instance of the Timer class with a given\n\tinterval, set its run() method to a custom function to be invoked and\n\teventually call stop() to stop the Timer.\n\n\tNote that a running Timer may or may not prevent the program to exit\n\tautomatically when main() returns.\n\n\tIt is also possible to extend this class and override its run() method in\n\tthe child class.\n**/\nclass Timer {\n\t#if (flash || js || java || python)\n\n\t#if (flash || js)\n\t\tprivate var id : Null<Int>;\n\t#elseif java\n\t\tprivate var timer : java.util.Timer;\n\t\tprivate var task : java.util.TimerTask;\n\t#end\n\n\t/**\n\t\tCreates a new timer that will run every `time_ms` milliseconds.\n\n\t\tAfter creating the Timer instance, it calls `this].run` repeatedly,\n\t\twith delays of `time_ms` milliseconds, until `this.stop` is called.\n\n\t\tThe first invocation occurs after `time_ms` milliseconds, not\n\t\timmediately.\n\n\t\tThe accuracy of this may be platform-dependent.\n\t**/\n\tpublic function new( time_ms : Int ){\n\t\t#if flash\n\t\t\tvar me = this;\n\t\t\tid = untyped __global__[\"flash.utils.setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif js\n\t\t\tvar me = this;\n\t\t\tid = untyped setInterval(function() me.run(),time_ms);\n\t\t#elseif java\n\t\t\ttimer = new java.util.Timer();\n\t\t\ttimer.scheduleAtFixedRate(task = new TimerTask(this), haxe.Int64.ofInt(time_ms), haxe.Int64.ofInt(time_ms));\n\t\t#end\n\t}\n\n\t/**\n\t\tStops `this` Timer.\n\n\t\tAfter calling this method, no additional invocations of `this.run`\n\t\twill occur.\n\n\t\tIt is not possible to restart `this` Timer once stopped.\n\t**/\n\tpublic function stop() {\n\t\t#if (flash || js)\n\t\t\tif( id == null )\n\t\t\t\treturn;\n\t\t\t#if flash\n\t\t\t\tuntyped __global__[\"flash.utils.clearInterval\"](id);\n\t\t\t#elseif js\n\t\t\t\tuntyped clearInterval(id);\n\t\t\t#end\n\t\t\tid = null;\n\t\t#elseif java\n\t\t\ttimer.cancel();\n\t\t\ttimer = null;\n\t\t\ttask = null;\n\t\t#end\n\t}\n\n\t/**\n\t\tThis method is invoked repeatedly on `this` Timer.\n\n\t\tIt can be overridden in a subclass, or rebound directly to a custom\n\t\tfunction:\n\t\t\tvar timer = new haxe.Timer(1000); // 1000ms delay\n\t\t\ttimer.run = function() { ... }\n\n\t\tOnce bound, it can still be rebound to different functions until `this`\n\t\tTimer is stopped through a call to `this.stop`.\n\t**/\n\tpublic dynamic function run() {\n\n\t}\n\n\t/**\n\t\tInvokes `f` after `time_ms` milliseconds.\n\n\t\tThis is a convenience function for creating a new Timer instance with\n\t\t`time_ms` as argument, binding its run() method to `f` and then stopping\n\t\t`this` Timer upon the first invocation.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function delay( f : Void -> Void, time_ms : Int ) {\n\t\tvar t = new haxe.Timer(time_ms);\n\t\tt.run = function() {\n\t\t\tt.stop();\n\t\t\tf();\n\t\t};\n\t\treturn t;\n\t}\n\n\t#end\n\n\t/**\n\t\tMeasures the time it takes to execute `f`, in seconds with fractions.\n\n\t\tThis is a convenience function for calculating the difference between\n\t\tTimer.stamp() before and after the invocation of `f`.\n\n\t\tThe difference is passed as argument to Log.trace(), with \"s\" appended\n\t\tto denote the unit. The optional `pos` argument is passed through.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function measure<T>( f : Void -> T, ?pos : PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\tLog.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\n\t/**\n\t\tReturns a timestamp, in seconds with fractions.\n\n\t\tThe value itself might differ depending on platforms, only differences\n\t\tbetween two values make sense.\n\t**/\n\tpublic static function stamp() : Float {\n\t\t#if flash\n\t\t\treturn flash.Lib.getTimer() / 1000;\n\t\t#elseif (neko || php)\n\t\t\treturn Sys.time();\n\t\t#elseif js\n\t\t\treturn Date.now().getTime() / 1000;\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__time_stamp();\n\t\t#elseif sys\n\t\t\treturn Sys.time();\n\t\t#else\n\t\t\treturn 0;\n\t\t#end\n\t}\n\n}\n\n#if java\n@:nativeGen\nprivate class TimerTask extends java.util.TimerTask {\n\tvar timer:Timer;\n\tpublic function new(timer:Timer):Void {\n\t\tsuper();\n\t\tthis.timer = timer;\n\t}\n\n\t@:overload override public function run():Void {\n\t\ttimer.run();\n\t}\n}\n#end\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\nprivate class StringMapIterator<T> {\n\tvar map : StringMap<T>;\n\tvar keys : Array<String>;\n\tvar index : Int;\n\tvar count : Int;\n\tpublic inline function new(map:StringMap<T>, keys:Array<String>) {\n\t\tthis.map = map;\n\t\tthis.keys = keys;\n\t\tthis.index = 0;\n\t\tthis.count = keys.length;\n\t}\n\tpublic inline function hasNext() {\n\t\treturn index < count;\n\t}\n\tpublic inline function next() {\n\t\treturn map.get(keys[index++]);\n\t}\n}\n\n@:coreApi class StringMap<T> implements haxe.Constraints.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\tprivate var rh : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tinline function isReserved(key:String) : Bool {\n\t\treturn untyped __js__(\"__map_reserved\")[key] != null;\n\t}\n\n\tpublic inline function set( key : String, value : T ) : Void {\n\t\tif( isReserved(key) )\n\t\t\tsetReserved(key, value);\n\t\telse\n\t\t\th[cast key] = value;\n\t}\n\n\tpublic inline function get( key : String ) : Null<T> {\n\t\tif( isReserved(key) )\n\t\t\treturn getReserved(key);\n\t\treturn h[cast key];\n\t}\n\n\tpublic inline function exists( key : String ) : Bool {\n\t\tif( isReserved(key) )\n\t\t\treturn existsReserved(key);\n\t\treturn h.hasOwnProperty(key);\n\t}\n\n\tfunction setReserved( key : String, value : T ) : Void {\n\t\tif( rh == null ) rh = {};\n\t\trh[cast \"$\"+key] = value;\n\t}\n\n\tfunction getReserved( key : String ) : Null<T> {\n\t\treturn rh == null ? null : rh[cast \"$\"+key];\n\t}\n\n\tfunction existsReserved( key : String ) : Bool {\n\t\tif( rh == null ) return false;\n\t\treturn untyped rh.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tif( isReserved(key) ) {\n\t\t\tkey = \"$\" + key;\n\t\t\tif( rh == null || !rh.hasOwnProperty(key) ) return false;\n\t\t\tuntyped __js__(\"delete\")(rh[key]);\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( !h.hasOwnProperty(key) )\n\t\t\t\treturn false;\n\t\t\tuntyped __js__(\"delete\")(h[key]);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\treturn arrayKeys().iterator();\n\t}\n\t\n\tfunction arrayKeys() : Array<String> {\n\t\tvar out = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\tout.push(key);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\tif( rh != null ) untyped {\n\t\t\t__js__(\"for( var key in this.rh ) {\");\n\t\t\t\tif( key.charCodeAt(0) == \"$\".code )\n\t\t\t\t\tout.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn out;\n\t}\n\n\tpublic inline function iterator() : Iterator<T> {\n\t\treturn new StringMapIterator(this, arrayKeys());\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar keys = arrayKeys();\n\t\tfor( i in 0...keys.length ) {\n\t\t\tvar k = keys[i];\n\t\t\ts.add(k);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(k)));\n\t\t\tif( i < keys.length )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __js__(\"var __map_reserved = {}\");\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nprivate class HaxeError extends js.Error {\n\n\tvar val:Dynamic;\n\n\tpublic function new(val:Dynamic) untyped {\n\t\tsuper();\n\t\tthis.val = __define_feature__(\"js.Boot.HaxeError\", val);\n\t\tthis.message = String(val);\n\t\tif (js.Error.captureStackTrace) js.Error.captureStackTrace(this, HaxeError);\n\t}\n}\n\n@:dox(hide)\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse {\n\t\t\tvar cl = untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t\t\tif (cl != null)\n\t\t\t\treturn cl;\n\t\t\tvar name = __nativeClassName(o);\n\t\t\tif (name != null)\n\t\t\t\treturn __resolveNativeClass(name);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") && __typeof__(tostr) == \"function\" ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"(o|0) === o\"));\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class or a native JS object\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if ( (untyped __js__(\"typeof\"))(cl) == \"object\" && __isNativeObj(cl) ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n\tstatic var __toStr = untyped __js__(\"{}.toString\");\n\t// get native JS [[Class]]\n\tstatic function __nativeClassName(o:Dynamic):String {\n\t\tvar name = untyped __toStr.call(o).slice(8, -1);\n\t\t// exclude general Object and Function\n\t\t// also exclude Math and JSON, because instanceof cannot be called on them\n\t\tif (name == \"Object\" || name == \"Function\" || name == \"Math\" || name == \"JSON\")\n\t\t\treturn null;\n\t\treturn name;\n\t}\n\n\t// check for usable native JS object\n\tstatic function __isNativeObj(o:Dynamic):Bool {\n\t\treturn __nativeClassName(o) != null;\n\t}\n\n\t// resolve native JS class in the global scope:\n\tstatic function __resolveNativeClass(name:String) {\n\t\treturn untyped js.Lib.global[name];\n\t}\n\n}\n"],
"names":[],
"mappings":"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"
}